{% extends './base.html' %}
{% load static %}

{% block css %}
    <link rel="stylesheet" href="{% static 'posts/css/post_detail.css' %}">
{% endblock css %}

{% block post_header %}
    <div class="container">
        <h1 class="title">{{post.title}}</h1>
        <p class="date">{{post.dt_created}}</p>
    </div>
{% endblock post_header %}

{% block content %}
    <div class="content">
        <p class="text">{{post.content|linebreaksbr}}</p>
        <p class="date_md">수정일 <span>{{post.dt_modified}}</span></p>
    </div>
    <div class="btn">
        <div class="btn_list"><a href="{% url 'post-list' %}">목록으로</a></div>
        <div class = 'right_btn'>
            <div class='btn_modify btn_post'><a href = "{% url 'post-update' post.id %}">수정하기</a></div>
            <div class='btn_delete' 'btn_post'><a href = "{% url 'post-delete' post.id %}">삭제하기</a></div>
        </div>
    </div>
    <div class="comments-section" style="max-width:700px; margin:40px auto 0 auto;">
        <h3 style="margin-bottom:18px; color:#e38917;">댓글</h3>
        {% if comments %}
            <ul style="padding:0; list-style:none;">
                {% for comment in comments %}
                <li style="background:rgba(38,37,42,0.85); color:#fff; border-radius:8px; margin-bottom:14px; padding:16px 18px;">
                    <div style="font-weight:600; color:#e38917; margin-bottom:6px;">{{ comment.author.nickname }}</div>
                    <div style="font-size:1.05rem; margin-bottom:8px;">{{ comment.content|linebreaksbr }}</div>
                    <div style="font-size:0.9rem; color:#aaa; text-align:right;">{{ comment.created_at|date:'Y-m-d H:i' }}</div>
                </li>
                {% endfor %}
            </ul>
        {% else %}
            <p style="color:#aaa;">아직 댓글이 없습니다.</p>
        {% endif %}
        {% if user.is_authenticated %}
        <form method="post" style="margin-top:24px;">
            {% csrf_token %}
            {{ comment_form.as_p }}
            <button type="submit" style="background:#e38917; color:#fff; border:none; border-radius:4px; padding:8px 22px; font-size:15px; font-weight:600; cursor:pointer;">댓글 작성</button>
        </form>
        {% else %}
        <p style="margin-top:24px; color:#aaa;">댓글을 작성하려면 <a href="{% url 'login' %}">로그인</a>이 필요합니다.</p>
        {% endif %}
    </div>
{% endblock content %}
